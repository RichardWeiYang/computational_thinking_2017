# 虚拟机

## 本章节逻辑模型

* 背景
    * 虚拟机在计算机软件架构中是非必要的一层，却为整个计算机软件架构的工业发展带来了重要的影响
    * 虚拟机体现了透过中间过渡层实现在上下隔离的同时上下兼容
* 目标
    * 让学生了解虚拟机是甚么
    * 让学生了解虚拟机在计算机软件架构中的作
    * 让学生了解虚拟机所体现的计算思维
* 输入
    * （见参考材料）
* 过程
    * 讲解虚拟机发展历史
    * 讲解虚拟机的核心功能
        * 如何兼容汇编语言
        * 如何兼容高级语言
    * 讲解虚拟机在计算机软件架构中的作用
    * 讲解虚拟机所体现的计算思维
* 输出
    * -
* 效果
    * -

## 虚拟机发展史

* 20世纪60年代
    * 1964年，IBM推出System/360
        * 通过虚拟机监视器(Virtual Machine Monitor)虚拟所有的硬件接口
    * 1965年，IBM公司的"M44/44X"计算机项目
        * 定义了虚拟内存管理机制
        * 分割的虚拟内存为多个用户的程序提供了独立的计算环境
    * 1968年，IBM小组研发剑桥监视系统（Cambridge Monitoring System，CMS）
        * 分时系统的一个实验

* 20世纪70年代
    * 1970年，IBM推出VM/370
        * 基于CMS开发多用户环境的操作系统
        * 许多企业和大学都使用这个操作系统, 因为它允许他们共享主机的计算能力和资源
        * 每个用户在他们自己的虚拟机中工作，从而可以和其他人共享资源而不影响其他人的工作
    * 1974年，贝尔实验室的Denise Richie和Ken Thompson (UNIX的发明者) 提出用虚拟机的概念来让运行进程
        * 让每个进程面对一个虚拟机器
        * 程序移植性提高

* 其后，虚拟机的概念被拓展, 如VMware实现了在一种操作系统上运行另一种操作系统等

## 虚拟机概念出现前

* 高级语言的实现依赖于存储硬件的实现
    * 计算机硬件的不同（如存储空间大小，存储硬件结构等）会导致高级语言编写的程序不能从一个平台迁移到另一个平台

* 每台计算机在一段时间内只能执行一组程序
    * 计算机的使用效率低

## 虚拟机解决的问题

* 虚拟硬件接口
    * 透过在虚拟机中提供逻辑接口
    * 上层软件默认可以透过逻辑接口控制硬制，或透过虚拟机反馈得知硬件不存在/未接入
    * [例] 在课堂上随便喊一个人的名字，如果这个人不在就会没有回应; 若有一个人管理出席学生的名单，那么就可以透过访问这个管理人知道这个人在不在甚至找到对应的人

* 虚拟存储空间
    * 定义了虚拟存储空间到物理存储空间的映射
    * 上层软件只看到连续的虚拟存储空间，即使它是由多个独立的物理存储空间组成的
        * 这是因为数字本身可以拆开，只需要按照一定顺序拼接即可还原
    * 基于虚拟存储空间，一台计算机分割为多个虚拟机
        * 为每台虚拟机分配独立的存储空间
            * 每台虚拟机只看到各自的虚拟存储空间而不会影响其他虚拟机的存储空间
            * 这种思想后被演变成操作系统中的进程
        * 计算机的每一瞬间只有台虚拟机在运行
            * 即计算机具体在运行该虚拟机上的程序
            * 透过时间片切换模拟多台虚拟机同时运行 (分时系统)
        * 让某台虚拟机能看到所有虚拟机并控制虚拟机之间的切换
            * 即操作系统
            * 利用软件来运行和管理子软件
* 虚拟存储空间上的堆栈操作
    * 定义了每个进程对应一个内存空间
    * 进程所运行的程序以堆栈的方式运用进程的内存空间


* 虚拟机成为了向上和向下兼容的中间层
    * 计算机科学家统一出来一种基于虚拟机的计算机逻辑框架
    * 自此
        * 新的硬件开发都需要能支持虚拟机的逻辑功能
        * 新的高级语言只需要基于虚拟机的逻辑实现即可迁移到一同规格的计算机上运行

## 虚拟机背后的计算思维

* 将具体而复杂的事物对应成抽象而简单的事物，提高解决问题的效率
    * [例] 搬家的时候桌子很碍空间，但是桌子可以挂解，分开运送后

* 透过在不同时间段使用同一组资源实现使用权的共享，提高资源利用率
    * [例] 一个住屋单位里有一个洗手间和多个房间，每个房间由不同人住，洗手间轮流使用

* 透过规范或限制使得过程更简单
    * [例] 封装好的开源工具库
    * [例] 统一的方法论
    * [例] 计算思维

## 参考材料

* 汇编语言出现的历史背景 [link](http://blog.csdn.net/shisiye15/article/details/7697399)
* 编程语言发展史上有哪些趣事？ - 知乎 [link](https://www.zhihu.com/question/19811764)
* 即使高手也未必知晓 虚拟机的历史 - cnBeta [link](http://www.cnbeta.com/articles/127802.htm)